<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>POWannier: POWannier::RSystem Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">POWannier
   &#160;<span id="projectnumber">0.2.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacePOWannier.html">POWannier</a></li><li class="navelem"><a class="el" href="classPOWannier_1_1RSystem.html">RSystem</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classPOWannier_1_1RSystem-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">POWannier::RSystem Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Object responsible for position operators diagonalization and subsequent <a class="el" href="classPOWannier_1_1Wannier.html" title="Wannier function.">Wannier</a> function creation.  
 <a href="classPOWannier_1_1RSystem.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rsystem_8h_source.html">rsystem.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2e9e3a5c1dbde7d72d71c78588a3f5ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a2e9e3a5c1dbde7d72d71c78588a3f5ea">RSystem</a> (std::shared_ptr&lt; <a class="el" href="classPOWannier_1_1BlochSystem.html">BlochSystem</a> &gt; bs, std::vector&lt; int &gt; <a class="el" href="classPOWannier_1_1RSystem.html#abe14484efc4799341ffe748f279ab4e0">bands</a>)</td></tr>
<tr class="memdesc:a2e9e3a5c1dbde7d72d71c78588a3f5ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="#a2e9e3a5c1dbde7d72d71c78588a3f5ea">More...</a><br /></td></tr>
<tr class="separator:a2e9e3a5c1dbde7d72d71c78588a3f5ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecba44780243daa5e2927e2106d1fa43"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#aecba44780243daa5e2927e2106d1fa43">RSystem</a> (std::shared_ptr&lt; <a class="el" href="classPOWannier_1_1BlochSystem.html">BlochSystem</a> &gt; bs, std::vector&lt; int &gt; <a class="el" href="classPOWannier_1_1RSystem.html#abe14484efc4799341ffe748f279ab4e0">bands</a>, <a class="el" href="classPOWannier_1_1WannierPositions.html">WannierPositions</a> positions)</td></tr>
<tr class="memdesc:aecba44780243daa5e2927e2106d1fa43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cnstructor for the case of degenerated <img class="formulaInl" alt="$ \hat{\lambda_1} $" src="form_114.png"/> eigenvalues.  <a href="#aecba44780243daa5e2927e2106d1fa43">More...</a><br /></td></tr>
<tr class="separator:aecba44780243daa5e2927e2106d1fa43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d03a2ed4a4b83120a79fb200bbc2537"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPOWannier_1_1Wannier.html">Wannier</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a2d03a2ed4a4b83120a79fb200bbc2537">getWannier</a> (<a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a> cellLocation)</td></tr>
<tr class="memdesc:a2d03a2ed4a4b83120a79fb200bbc2537"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a Wannier function at a given call (single band only)  <a href="#a2d03a2ed4a4b83120a79fb200bbc2537">More...</a><br /></td></tr>
<tr class="separator:a2d03a2ed4a4b83120a79fb200bbc2537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69899b039f32cc8bd080d18831a09d19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPOWannier_1_1Wannier.html">Wannier</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a69899b039f32cc8bd080d18831a09d19">getWannier</a> (<a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a> cellLocation, <a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a> wanLocation)</td></tr>
<tr class="memdesc:a69899b039f32cc8bd080d18831a09d19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a Wannier function at a given call (general case)  <a href="#a69899b039f32cc8bd080d18831a09d19">More...</a><br /></td></tr>
<tr class="separator:a69899b039f32cc8bd080d18831a09d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71cfadd1eff15bab67037e2820074ab9"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacePOWannier.html#ade0149e64d39b11d71799054e057b82d">Eigensystem</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a71cfadd1eff15bab67037e2820074ab9">getEigensystem</a> (int n)</td></tr>
<tr class="memdesc:a71cfadd1eff15bab67037e2820074ab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the eigensystem of <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/>.  <a href="#a71cfadd1eff15bab67037e2820074ab9">More...</a><br /></td></tr>
<tr class="separator:a71cfadd1eff15bab67037e2820074ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead037ce3943e2a3f82b814da84f7de8"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacePOWannier.html#ade0149e64d39b11d71799054e057b82d">Eigensystem</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#aead037ce3943e2a3f82b814da84f7de8">getSubEigensystem</a> (int n, <a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a> cellLocation, <a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a> wanLocation)</td></tr>
<tr class="memdesc:aead037ce3943e2a3f82b814da84f7de8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the eigensystem <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/> in <code>n</code>-th subspace.  <a href="#aead037ce3943e2a3f82b814da84f7de8">More...</a><br /></td></tr>
<tr class="separator:aead037ce3943e2a3f82b814da84f7de8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f8b722f0b761afad183e1309d7fc639"><td class="memItemLeft" align="right" valign="top">const arma::vec &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a6f8b722f0b761afad183e1309d7fc639">getEigenvalues</a> (int n)</td></tr>
<tr class="memdesc:a6f8b722f0b761afad183e1309d7fc639"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the eigenvalues of <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/>.  <a href="#a6f8b722f0b761afad183e1309d7fc639">More...</a><br /></td></tr>
<tr class="separator:a6f8b722f0b761afad183e1309d7fc639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2087aa327f78da3f8307752a15ba8301"><td class="memItemLeft" align="right" valign="top">const arma::cx_mat &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a2087aa327f78da3f8307752a15ba8301">getEigenvectors</a> (int n)</td></tr>
<tr class="memdesc:a2087aa327f78da3f8307752a15ba8301"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the eigenvectors of <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/>.  <a href="#a2087aa327f78da3f8307752a15ba8301">More...</a><br /></td></tr>
<tr class="separator:a2087aa327f78da3f8307752a15ba8301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247c7f88ce438a1a5c5a969ff2959067"><td class="memItemLeft" align="right" valign="top">const arma::vec &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a247c7f88ce438a1a5c5a969ff2959067">getSubEigenvalues</a> (int n, <a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a> cellLocation, <a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a> wanLocation)</td></tr>
<tr class="memdesc:a247c7f88ce438a1a5c5a969ff2959067"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the eigenvalues <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/> in <code>n</code>-th subspace.  <a href="#a247c7f88ce438a1a5c5a969ff2959067">More...</a><br /></td></tr>
<tr class="separator:a247c7f88ce438a1a5c5a969ff2959067"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a605852df405b5bef3d5a10f2ff112ec5"><td class="memItemLeft" align="right" valign="top">const arma::cx_mat &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a605852df405b5bef3d5a10f2ff112ec5">getSubEigenvectors</a> (int n, <a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a> cellLocation, <a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a> wanLocation)</td></tr>
<tr class="memdesc:a605852df405b5bef3d5a10f2ff112ec5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the eigenvectors <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/> in <code>n</code>-th subspace.  <a href="#a605852df405b5bef3d5a10f2ff112ec5">More...</a><br /></td></tr>
<tr class="separator:a605852df405b5bef3d5a10f2ff112ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a614f4d9a3c3d0588d54ec876dd94bc94"><td class="memItemLeft" align="right" valign="top"><a id="a614f4d9a3c3d0588d54ec876dd94bc94"></a>
const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a614f4d9a3c3d0588d54ec876dd94bc94">N</a></td></tr>
<tr class="memdesc:a614f4d9a3c3d0588d54ec876dd94bc94"><td class="mdescLeft">&#160;</td><td class="mdescRight">System size (number of cells in each direction). <br /></td></tr>
<tr class="separator:a614f4d9a3c3d0588d54ec876dd94bc94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5d9f72a9a2477dcaefbe72eb1fef2a"><td class="memItemLeft" align="right" valign="top"><a id="a8c5d9f72a9a2477dcaefbe72eb1fef2a"></a>
const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a8c5d9f72a9a2477dcaefbe72eb1fef2a">dim</a></td></tr>
<tr class="memdesc:a8c5d9f72a9a2477dcaefbe72eb1fef2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of the system. <br /></td></tr>
<tr class="separator:a8c5d9f72a9a2477dcaefbe72eb1fef2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f72e91ea37c71d276e647796fc843e"><td class="memItemLeft" align="right" valign="top"><a id="ad5f72e91ea37c71d276e647796fc843e"></a>
const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#ad5f72e91ea37c71d276e647796fc843e">mdim</a></td></tr>
<tr class="memdesc:ad5f72e91ea37c71d276e647796fc843e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of the quasimomentum basis. <br /></td></tr>
<tr class="separator:ad5f72e91ea37c71d276e647796fc843e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a497af4a4429933e8258880fad3a0405e"><td class="memItemLeft" align="right" valign="top"><a id="a497af4a4429933e8258880fad3a0405e"></a>
const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#a497af4a4429933e8258880fad3a0405e">bmdim</a></td></tr>
<tr class="memdesc:a497af4a4429933e8258880fad3a0405e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of the quasimomentum+band indices basis. <br /></td></tr>
<tr class="separator:a497af4a4429933e8258880fad3a0405e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe14484efc4799341ffe748f279ab4e0"><td class="memItemLeft" align="right" valign="top"><a id="abe14484efc4799341ffe748f279ab4e0"></a>
const std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#abe14484efc4799341ffe748f279ab4e0">bands</a></td></tr>
<tr class="memdesc:abe14484efc4799341ffe748f279ab4e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bands used in the calculations. <br /></td></tr>
<tr class="separator:abe14484efc4799341ffe748f279ab4e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0779c528ec84d3abb6e47eec9236c3a"><td class="memItemLeft" align="right" valign="top"><a id="ad0779c528ec84d3abb6e47eec9236c3a"></a>
const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOWannier_1_1RSystem.html#ad0779c528ec84d3abb6e47eec9236c3a">cutoff</a></td></tr>
<tr class="memdesc:ad0779c528ec84d3abb6e47eec9236c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cutoff in plane wave expansion of Bloch and Wannier functions. <br /></td></tr>
<tr class="separator:ad0779c528ec84d3abb6e47eec9236c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p class="">Object responsible for position operators diagonalization and subsequent <a class="el" href="classPOWannier_1_1Wannier.html" title="Wannier function.">Wannier</a> function creation. </p>
<dl class="section user"><dt>Introduction</dt><dd>Most lattice models have an effective (small) range of interactions between the particles present therein. This assumption naturally leads to the <a href="https://en.wikipedia.org/wiki/Tight_binding">tight binding model </a> in which the particles are represented in the basis of local (exponentially decaying) functions. An example of such basis are the Wannier functions, which for simple systems can be calculated directly from the Bloch functions (see <a class="el" href="classPOWannier_1_1Bloch.html" title="Bloch function calculated for a given reciprocal lattice vector.">Bloch</a>): <br />
 <img class="formulaInl" alt="$ W_{\alpha,\vec{R}} (\vec{r}) = \frac{1}{\sqrt{N^{dim}}} \sum_{\vec{k}} e^{-i\vec{k}\vec{R}}\phi_{i,\vec{k}}(\vec{r}). $" src="form_109.png"/> <br />
 In the case of more complicated lattice potentials the above formula does not work (that is, the resulting basis functions are not local). Here a simple approach to generating <a class="el" href="classPOWannier_1_1Wannier.html" title="Wannier function.">Wannier</a> functions is taken, namely the diagonalization of the position operators in the Bloch function bases <a class="el" href="citelist.html#CITEREF_kivelson82">[2]</a>, which has already been succesfully applied to optical lattice systems <a class="el" href="citelist.html#CITEREF_bissbort2012">[1]</a>.</dd></dl>
<dl class="section user"><dt>Position operators diagonalization method details</dt><dd>The position operators here are defined as: <img class="formulaInl" alt="$ \hat{\lambda}_i = \frac{\vec{b}_i}{2\pi} $" src="form_65.png"/>. In order to diagonalize these operators, a Hamiltonian matrix may be easily constructed: (here, <img class="formulaInl" alt="$ p $" src="form_74.png"/> and <img class="formulaInl" alt="$ q $" src="form_75.png"/> are the indices combining <img class="formulaInl" alt="$ \vec{k} $" src="form_7.png"/> (in the form of <code>m</code>) and the band index): <br />
 <img class="formulaInl" alt="$ (\Lambda_i)_{p,q} = \langle \phi_{\alpha, \vec{k}} | \hat{\lambda_i} | \phi_{\beta, \vec{k}'} \rangle = \frac{1}{\Omega} \int_{\Omega} d\vec{r} \lambda_i \sum_{m, n, m', n'} u^*_{\alpha,n} u_{\alpha,n'} e^{i \sum_j (n_j' - n_j + (m_j' - m_j)/N) \vec{b}_j \vec{r} } $" src="form_79.png"/> <br />
 In order to evaluate this integral, the following change of variables is used: <img class="formulaInl" alt="$ \vec{r}_i = N \vec{a_i} \lambda_i + c $" src="form_67.png"/>, where the constant <img class="formulaInl" alt="$ c $" src="form_68.png"/> depends on whether <code>N</code> is odd or even: <img class="formulaInl" alt="$ c_{odd} = 0 $" src="form_69.png"/>, <img class="formulaInl" alt="$ c_{even} = \vec{a_i}/2 $" src="form_70.png"/>. This change has an associated Jacobian determinant equal to <img class="formulaInl" alt="$ \Omega $" src="form_63.png"/> and, assuming that <img class="formulaInl" alt="$\vec{r} = \vec{0}$" src="form_87.png"/> is in the middle of the <img class="formulaInl" alt="$ (N+1)/2 $" src="form_71.png"/>-th cell in the odd <code>N</code> case (and <img class="formulaInl" alt="$ (N/2) $" src="form_72.png"/>-th cell in th even <code>N</code> case), changes the boundaries of integration (now in dimensionless <img class="formulaInl" alt="$ d\lambda_i $" src="form_73.png"/>) to {-1/2, 1/2}. After additional change of order between integration and summations and noticing that the integrals in each ( <img class="formulaInl" alt="$ \lambda_i $" src="form_77.png"/>) direction can now be sepereated, we finally get (in the even <code>N</code> case): <br />
 <img class="formulaInl" alt="$ (\Lambda_i)_{p,q} = \sum_{m, n, m', n'} I_{i, m_j, n_j, m_j', n_j'} \prod_{j\neq i} I_{m_j, n_j, m_j', n_j'} $" src="form_88.png"/>, where: <br />
 <img class="formulaInl" alt="$ I_{j, m_j, n_j, m_j', n_j'} = \int_{-1/2}^{1/2} d\lambda_j \lambda_j e^{2\pi i s_j \lambda_j} $" src="form_85.png"/>, <br />
 <img class="formulaInl" alt="$ I_{m_j, n_j, m_j', n_j'} = \int_{-1/2}^{1/2} d\lambda_j e^{2\pi i s_j \lambda_j} $" src="form_86.png"/>, <br />
and <img class="formulaInl" alt="$ s_i = (N(n_i' - n_i) + m_i' - m_i) $" src="form_83.png"/>. <br />
 <br />
These integrals can be done analytically, resulting in: <br />
 <img class="formulaInl" alt="$ I_{j, m_j, n_j, m_j', n_j'} = \sinc(\pi s_j) = \delta_{s_j, 0} $" src="form_89.png"/>, <br />
 <img class="formulaInl" alt="$ I_{m_j, n_j, m_j', n_j'} = \frac{i (-s_j \pi \cos(\pi s_j)) + \sin(\pi s_j)}{2 \pi^2 s_j^2} = \frac{i}{2\pi s_j}(-1)^{s_j+1} (1-\delta_{s_j,0}) $" src="form_90.png"/>, <br />
where the second equations in both lines follow from the fact that <img class="formulaInl" alt="$ s_j \in \mathbb{Z} $" src="form_93.png"/>. We also have <img class="formulaInl" alt="$s_j = 0 \iff m_j = m_j' \wedge n_j = n_j' $" src="form_97.png"/>, because <img class="formulaInl" alt="$ 0 \leq \max(m_j' - m_j) - \min(m_i' - m_i) &lt; N $" src="form_98.png"/>. Because of this fact and the delta functions in the result, each <img class="formulaInl" alt="$ \Lambda_i $" src="form_99.png"/> can be represented in block diagonal form, where for each block the following is true: <img class="formulaInl" alt="$ \forall_{j \neq i} m_j = m_j' \wedge n_j = n_j' $" src="form_100.png"/>, which can significantly speed up the diagonalization process. <br />
 <br />
 The final procedure of finding the Wannier function centered at position <img class="formulaInl" alt="$ \vec{R} = \{R_1, R_2, \dots, R_{dim}\} $" src="form_127.png"/> consists of the following loop: <ul>
<li>
diagonalize <img class="formulaInl" alt="$\Lambda_i$" src="form_102.png"/> in the subspace of eigenfunctions, whose eigenvalues correspond to positions <img class="formulaInl" alt="$ R_1, R_2, \dots, R_{i-1} $" src="form_103.png"/>  </li>
<li>
select the eigenfunctions of <img class="formulaInl" alt="$ \Lambda_i $" src="form_99.png"/> that form the degenerated subspace with the eigenvalue corresponding to the position <img class="formulaInl" alt="$ R_i $" src="form_104.png"/>, as that subspace will be used in the next iteration of the loop.</li>
</ul>
Before the first (<code>i</code> = 1) step, the current subspace is the whole space spanned by all <img class="formulaInl" alt="$ \phi_{\alpha,\vec{k}} $" src="form_105.png"/> Bloch functions. After the final (<code>i</code> = <code>dim</code>) step, the result will be a localized function centered at position <img class="formulaInl" alt="$\vec{R}$" src="form_107.png"/>, that is <img class="formulaInl" alt="$W_{\vec{R}} (\vec{r})$" src="form_108.png"/>. Note that here the Wannier function does not have a band index &ndash; in general, this function may be spanning multiple bands (for example, this happens when there are multiple potential wells of similar depth in a single elementary cell). }</dd></dl>
<dl class="section user"><dt>Wannier function selection process</dt><dd>The selection of <img class="formulaInl" alt="$\vec{R}$" src="form_107.png"/> in this class is done in two steps: first, the cell is selected (using NPoint <code>cellLocation</code> parameter &ndash; <img class="formulaInl" alt="$ \vec{0} $" src="form_110.png"/> correspond to the middle of the lattice) and after that, using NPoint <code>wanLocation</code> an appropiate Wannier function can be chosen. NPoint <code>wanLocation</code> is set up to cover all cases and the process can be simplified in some of them:<ul>
<li>If there is only one Wannier function in the cell for the energy given by the band energy, <code>wanLocation</code> may be omitted</li>
<li>If the eigenvalues of <img class="formulaInl" alt="$\Lambda_1$" src="form_111.png"/> is nondegenerate, it is enough to provide only single index as <code>wanLocation</code>, <code>{n}</code>, and by doing so Wannier corresponding the <code>n</code>-th <img class="formulaInl" alt="$ \Lambda_1 $" src="form_112.png"/> eigenvalue will be given.</li>
<li>If some of eigenvalues of <img class="formulaInl" alt="$\Lambda_1$" src="form_111.png"/> are degenerate, it is necessary to provide information on this degeneracy while constructing the <a class="el" href="classPOWannier_1_1RSystem.html" title="Object responsible for position operators diagonalization and subsequent Wannier function creation.">RSystem</a> (using WannierLocation object) and then each index <img class="formulaInl" alt="$ \textrm{wanLocation}_i $" src="form_113.png"/> specifies which of the eigenvalues is to be chosen at <code>i</code> step of the diagonalization. loop.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="comment">// Trivial case: one-dimensional sin^2(k_l x) potential</span></div><div class="line"><span class="keywordtype">double</span> kl = <a class="code" href="namespacePOWannier.html#aedeb6e9743834315c90f5abf12baa23d">pi</a>;</div><div class="line"></div><div class="line"><span class="keyword">auto</span> basis = std::vector&lt;POWannier::Vector&gt; { {<a class="code" href="namespacePOWannier.html#aedeb6e9743834315c90f5abf12baa23d">pi</a>/kl} };</div><div class="line"></div><div class="line"><span class="keyword">auto</span> sineSquare = [] (<a class="code" href="namespacePOWannier.html#a963f76c82f34b283daec733b5a6e3997">Position</a> r) {</div><div class="line">  <span class="comment">// Only r[0] is needed since the potential is in 1d</span></div><div class="line">  <span class="keywordflow">return</span> std::pow(std::sin(kl * r[0]), 2);</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">auto</span> V = <a class="code" href="classPOWannier_1_1Potential.html#a6dcc0bf4066852c815d432ce6eb29109">POWannier::Potential::create</a>()</div><div class="line">  .<a class="code" href="classPOWannier_1_1PotentialBuilder.html#a92aa4a5f2ea8bcbbbc01d47982146881">setBasis</a>(basis)</div><div class="line">  .<a class="code" href="classPOWannier_1_1PotentialBuilder.html#a14b27a08769f55ae14c832100ccd3ce9">evaluateFromFunction</a>(func)</div><div class="line">  .<a class="code" href="classPOWannier_1_1PotentialFunctionBuilder.html#a274b6de8d9be69787502f1fc73e2aab9">setCutoff</a>(1)  <span class="comment">// enough to capture this potential exactly</span></div><div class="line">  .<a class="code" href="classPOWannier_1_1PotentialFunctionBuilder.html#aa263db2054d4dca180a79d3816a6950b">complete</a>();</div><div class="line"></div><div class="line"><span class="keyword">auto</span> bs = std::make_shared&lt;POWannier::BlochSystem&gt;(</div><div class="line">  <a class="code" href="classPOWannier_1_1BlochSystem.html#a9e170c4c06357b0b6fe75fb8a464b2e7">POWannier::BlochSystem::createWithPotential</a>(V)</div><div class="line">    .<a class="code" href="classPOWannier_1_1BlochSystem_1_1BlochSystemBuilder.html#a7b646ee8a2acb22c1270494b2bbbedd2">setLaserWavelength</a>(kl)</div><div class="line">    .<a class="code" href="classPOWannier_1_1BlochSystem_1_1BlochSystemBuilder.html#afa40a161129856a7a9b0873dfdb5a394">setFourierCutoff</a>(20)</div><div class="line">    .<a class="code" href="classPOWannier_1_1BlochSystem_1_1BlochSystemBuilder.html#a8e48d4c6cd806bcc930477810103efdd">setSystemSize</a>(8)</div><div class="line">    .<a class="code" href="classPOWannier_1_1BlochSystem_1_1BlochSystemBuilder.html#a58c4e2d07e043e8f499e326b0508e498">setPotentialDepth</a>(8)</div><div class="line">    .<a class="code" href="classPOWannier_1_1BlochSystem_1_1BlochSystemBuilder.html#ad0cc7ab25c244c26604b9152966ba858">complete</a>()</div><div class="line">);</div><div class="line"></div><div class="line"><a class="code" href="classPOWannier_1_1RSystem.html">POWannier::RSystem</a> rs(bs, {0});</div><div class="line"></div><div class="line"></div><div class="line"><a class="code" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">POWannier::NPoint</a> n({0}); <span class="comment">// Wannier in the middle of the lattice</span></div><div class="line"><span class="keyword">auto</span> wan = rs.<a class="code" href="classPOWannier_1_1RSystem.html#a2d03a2ed4a4b83120a79fb200bbc2537">getWannier</a>(n);</div><div class="line">wan.<a class="code" href="classPOWannier_1_1Wannier.html#a8f75d63dd815ec6e69d5b906d1db9737">draw</a>(<span class="stringliteral">&quot;wan1d.dat&quot;</span>, 100, <a class="code" href="namespacePOWannier.html#ab1dbcd04d2fc301a9ea3418675e007d6ad08894bfec5b7b4b78cf904770f451d2">POWannier::DrawRange::WholeLattice</a>);</div></div><!-- fragment --></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classPOWannier_1_1Bloch.html" title="Bloch function calculated for a given reciprocal lattice vector.">Bloch</a> </dd>
<dd>
<a class="el" href="classPOWannier_1_1BlochSystem.html" title="Bloch functions calculated for a given lattice system.">BlochSystem</a> </dd>
<dd>
<a class="el" href="classPOWannier_1_1Wannier.html" title="Wannier function.">Wannier</a> </dd>
<dd>
<a class="el" href="classPOWannier_1_1WannierPositions.html" title="Specification of the degeneracy of the eigenvalues of  operator.">WannierPositions</a> </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2e9e3a5c1dbde7d72d71c78588a3f5ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9e3a5c1dbde7d72d71c78588a3f5ea">&#9670;&nbsp;</a></span>RSystem() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">POWannier::RSystem::RSystem </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classPOWannier_1_1BlochSystem.html">BlochSystem</a> &gt;&#160;</td>
          <td class="paramname"><em>bs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>bands</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bs</td><td><a class="el" href="classPOWannier_1_1BlochSystem.html" title="Bloch functions calculated for a given lattice system.">BlochSystem</a> containing Bloch functions of the system. </td></tr>
    <tr><td class="paramname">bands</td><td>Specify from which bands Bloch functions are to be used. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aecba44780243daa5e2927e2106d1fa43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecba44780243daa5e2927e2106d1fa43">&#9670;&nbsp;</a></span>RSystem() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">POWannier::RSystem::RSystem </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classPOWannier_1_1BlochSystem.html">BlochSystem</a> &gt;&#160;</td>
          <td class="paramname"><em>bs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>bands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPOWannier_1_1WannierPositions.html">WannierPositions</a>&#160;</td>
          <td class="paramname"><em>positions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cnstructor for the case of degenerated <img class="formulaInl" alt="$ \hat{\lambda_1} $" src="form_114.png"/> eigenvalues. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bs</td><td>std::shared_ptr to <a class="el" href="classPOWannier_1_1BlochSystem.html" title="Bloch functions calculated for a given lattice system.">BlochSystem</a> containing Bloch functions of the system. </td></tr>
    <tr><td class="paramname">bands</td><td>Specify from which bands Bloch functions are to be used. </td></tr>
    <tr><td class="paramname">positions</td><td>Characterization of the eigenvalues degeneracies for a single elementary cell (see <a class="el" href="classPOWannier_1_1WannierPositions.html" title="Specification of the degeneracy of the eigenvalues of  operator.">WannierPositions</a>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>positions</code> must contain total positions number (leafs number) equal to the number of bands supplied (as <code>bands</code>). </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>if the condition on positions number is not met. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classPOWannier_1_1WannierPositions.html" title="Specification of the degeneracy of the eigenvalues of  operator.">WannierPositions</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a71cfadd1eff15bab67037e2820074ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71cfadd1eff15bab67037e2820074ab9">&#9670;&nbsp;</a></span>getEigensystem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacePOWannier.html#ade0149e64d39b11d71799054e057b82d">Eigensystem</a>&amp; POWannier::RSystem::getEigensystem </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the eigensystem of <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>The chosen dimension. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The Eigensystem of <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/> operator in the whole space. </dd></dl>

</div>
</div>
<a id="a6f8b722f0b761afad183e1309d7fc639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f8b722f0b761afad183e1309d7fc639">&#9670;&nbsp;</a></span>getEigenvalues()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const arma::vec&amp; POWannier::RSystem::getEigenvalues </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the eigenvalues of <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/>. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classPOWannier_1_1RSystem.html#a71cfadd1eff15bab67037e2820074ab9" title="Get the eigensystem of .">getEigensystem()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The eigenvalues of the <img class="formulaInl" alt="$ \hat{\lambda}_n $" src="form_119.png"/> operator. </dd></dl>

</div>
</div>
<a id="a2087aa327f78da3f8307752a15ba8301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2087aa327f78da3f8307752a15ba8301">&#9670;&nbsp;</a></span>getEigenvectors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const arma::cx_mat&amp; POWannier::RSystem::getEigenvectors </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the eigenvectors of <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/>. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classPOWannier_1_1RSystem.html#a71cfadd1eff15bab67037e2820074ab9" title="Get the eigensystem of .">getEigensystem()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The eigenvectors of the <img class="formulaInl" alt="$ \hat{\lambda}_n $" src="form_119.png"/> operator. </dd></dl>

</div>
</div>
<a id="aead037ce3943e2a3f82b814da84f7de8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead037ce3943e2a3f82b814da84f7de8">&#9670;&nbsp;</a></span>getSubEigensystem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacePOWannier.html#ade0149e64d39b11d71799054e057b82d">Eigensystem</a>&amp; POWannier::RSystem::getSubEigensystem </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a>&#160;</td>
          <td class="paramname"><em>cellLocation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a>&#160;</td>
          <td class="paramname"><em>wanLocation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the eigensystem <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/> in <code>n</code>-th subspace. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>The chosen dimension. </td></tr>
    <tr><td class="paramname">cellLocation</td><td>See <a class="el" href="classPOWannier_1_1RSystem.html#a2d03a2ed4a4b83120a79fb200bbc2537" title="Construct a Wannier function at a given call (single band only)">getWannier(NPoint)</a>. </td></tr>
    <tr><td class="paramname">wanLocation</td><td>See <a class="el" href="classPOWannier_1_1RSystem.html#a69899b039f32cc8bd080d18831a09d19" title="Construct a Wannier function at a given call (general case)">getWannier(NPoint,NPoint)</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The Eigensystem of <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/> operator in the subspace used in the <code>i</code>-th step of the diagonalization loop, while using <code>cellLocation</code> and <code>wanLocation</code>. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Only the first <code>n</code> of indices in both <code>cellLocation</code> and <code>wanLocation</code> are used. </dd></dl>

</div>
</div>
<a id="a247c7f88ce438a1a5c5a969ff2959067"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a247c7f88ce438a1a5c5a969ff2959067">&#9670;&nbsp;</a></span>getSubEigenvalues()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const arma::vec&amp; POWannier::RSystem::getSubEigenvalues </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a>&#160;</td>
          <td class="paramname"><em>cellLocation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a>&#160;</td>
          <td class="paramname"><em>wanLocation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the eigenvalues <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/> in <code>n</code>-th subspace. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classPOWannier_1_1RSystem.html#aead037ce3943e2a3f82b814da84f7de8" title="Get the eigensystem  in n-th subspace.">getSubEigensystem()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The eigenvalues of the <code>n</code>-th subspace. </dd></dl>

</div>
</div>
<a id="a605852df405b5bef3d5a10f2ff112ec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a605852df405b5bef3d5a10f2ff112ec5">&#9670;&nbsp;</a></span>getSubEigenvectors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const arma::cx_mat&amp; POWannier::RSystem::getSubEigenvectors </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a>&#160;</td>
          <td class="paramname"><em>cellLocation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a>&#160;</td>
          <td class="paramname"><em>wanLocation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the eigenvectors <img class="formulaInl" alt="$\hat{\lambda_n}$" src="form_117.png"/> in <code>n</code>-th subspace. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classPOWannier_1_1RSystem.html#aead037ce3943e2a3f82b814da84f7de8" title="Get the eigensystem  in n-th subspace.">getSubEigensystem()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The eigenvectors of the <code>n</code>-th subspace. </dd></dl>

</div>
</div>
<a id="a2d03a2ed4a4b83120a79fb200bbc2537"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d03a2ed4a4b83120a79fb200bbc2537">&#9670;&nbsp;</a></span>getWannier() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPOWannier_1_1Wannier.html">Wannier</a> POWannier::RSystem::getWannier </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a>&#160;</td>
          <td class="paramname"><em>cellLocation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a Wannier function at a given call (single band only) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cellLocation</td><td>Location of the cell containing selected Wannier function. <img class="formulaInl" alt="$ \vec{0} $" src="form_110.png"/> is the middle of the lattice. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Wannier function <img class="formulaInl" alt="$ W_{\vec{R}}(\vec{r}) $" src="form_115.png"/>, where <img class="formulaInl" alt="$ \vec{R} $" src="form_101.png"/> corresponds to a given $@ cellLocation. </dd></dl>

</div>
</div>
<a id="a69899b039f32cc8bd080d18831a09d19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69899b039f32cc8bd080d18831a09d19">&#9670;&nbsp;</a></span>getWannier() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPOWannier_1_1Wannier.html">Wannier</a> POWannier::RSystem::getWannier </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a>&#160;</td>
          <td class="paramname"><em>cellLocation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacePOWannier.html#ae9850d4923cce5fcb8da9f258c3b9a32">NPoint</a>&#160;</td>
          <td class="paramname"><em>wanLocation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a Wannier function at a given call (general case) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cellLocation</td><td>Location of the cell containing selected Wannier function. <img class="formulaInl" alt="$ \vec{0} $" src="form_110.png"/> is the middle of the lattice. </td></tr>
    <tr><td class="paramname">wanLocation</td><td>Location of the Wannier function inside of the cell chosen by <code>cellLocation</code>. The <img class="formulaInl" alt="$ \textrm{wanLocation}_i $" src="form_113.png"/> index corresponds to which eigenvalue of <img class="formulaInl" alt="$\hat{\lambda}_i$" src="form_116.png"/> should be chosen. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Wannier function <img class="formulaInl" alt="$ W_{\vec{R}}(\vec{r}) $" src="form_115.png"/>, where <img class="formulaInl" alt="$ \vec{R} $" src="form_101.png"/> corresponds to a given <code>cellLocation</code>. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/powannier/<a class="el" href="rsystem_8h_source.html">rsystem.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
